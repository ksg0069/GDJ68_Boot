<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
  <mapper namespace="com.winter.app.board.notice.NoticeDAO">
  
  	<sql id="forPager">
		<choose>
			<when test="kind == '1'">
				BOARDTITLE
			</when>
			<when test="kind == '2' ">
				BOARDCONTENTS
			</when>
			<otherwise>
				BOARDWRITER
			</otherwise>
		</choose>
  	</sql>
  	
  	<select id="getCount" parameterType="Pager" resultType="Long">
  		<bind name="pattern" value="'%'+_parameter.getSearch()+'%'"/>
  		SELECT COUNT(BOARDNO) FROM NOTICE
  		WHERE <include refid="forPager"></include>
  		LIKE #{pattern}
  	</select>
  
  	
  	<!-- LIST -->
  	<select id="getList" resultType="NoticeVO" parameterType="Pager">
  	SELECT * FROM NOTICE
	WHERE
	<include refid="forPager"></include>
	LIKE CONCAT('%',#{search},'%')
	ORDER BY BOARDNO DESC
	LIMIT #{startRow}, #{lastRow} <!--#{} getter의 이름 -->
  	</select>
  	
  	<!-- add -->
  	<insert id="add" parameterType="BoardVO">
  		INSERT INTO NOTICE
  		VALUES(NULL,#{boardTitle},#{boardWriter},#{boardContents},now(),0)
  	</insert>
  	
  	<!--detail  -->
  	<select id="getDetail" resultType="NoticeVO" parameterType="BoardVO">
  		SELECT * FROM NOTICE
  		WHERE BOARDNO =#{boardNo}
  	</select>
  	
  	<!-- update -->
  	<update id="setUpdate" parameterType="BoardVO">
  		UPDATE NOTICE SET BOARDTITLE=#{boardTitle}, BOARDCONTENTS = #{boardContents}
  		WHERE BOARDNO = #{boardNo}
  	</update>
  	
  	<!-- 조회수 업데이트 -->
  	<update id="setHitUpdate" parameterType="BoardVO">
  		UPDATE NOTICE SET BOARDHIT = BOARDHIT + 1
  		WHERE BOARDNO = #{boardNo}
  	</update>
  	
  	<!-- delete -->
  	<delete id="setDelete" parameterType="BoardVO">
  		DELETE FROM NOTICE WHERE BOARDNO = #{boardNo}
  	</delete>
  
  </mapper>
  
